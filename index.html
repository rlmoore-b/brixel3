<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brixel, Order</title>
    <style>
        body {
            font-family: 'Nunito Sans', 'Nunito Sans', Geneva, Verdana, sans-serif;
            background-color: #EEEEEE;
            color: #000;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: right;
            align-items: right;
            height: 100vh;
        }

        .sidenav {
          width: 20%;
          min-width: 250px;
          height: 100%;
          position: fixed;
          z-index: 1;
          top: 0px;
          left: 0px;
          background: #fff;
          overflow-x: hidden;
          padding: 0px 0;
        }

        .sidenav img {
          padding: 16px 8px 16px 16px;

        }

        .sidenav a {
          padding: 16px 8px 16px 16px;
          text-decoration: none;
          font-size: 25px;
          color: #000000;
          display: block;
          align-self: left;
        }

        .sidenav a:hover {
          color: #064579;
        }
        .input-group {
          display: flex;
          justify-content: start;
          align-items: center;
          margin-bottom: 10px;
        }

        .input-group label {
          margin-right: 10px;
          white-space: nowrap;
          /* Set a fixed width for the labels to align them nicely */
          width: 70px;
        }

        .input-group input {
          /* Adjust the width of the input to ensure it doesn't exceed the container's width */
          width: 70px; /* Adjust as needed, make sure the sum of label width and input width is less than 100% */
          margin-right: 10px; /* Optional: Adds some space after the input */
          
        }

        .container {
            width: 80%;
            min-width: 500px;


            box-shadow: 0 0 15px rgba(0,0,0,0.2);
            border-radius: 8px;
            overflow: hidden;
        }
        .header {
            background-color: #ff8c00;
            color: white;
            padding: 8px;
            text-align: center;
            font-size: 18px;

        }
        .center {
        display: block;
        margin-left: auto;
        margin-right: auto;
        width: 50%;
        }
        .form-container {
            display: flex;
            justify-content: space-between; /* Adjusts the space between the form and invoice box */
            padding: 20px;
        }

        form {
            flex: 1; /* Takes up as much space as needed */
            margin-right: 20px; /* Adds some space between the form and the invoice box */
        }

        .invoice-box {
            width: 45%; /* Adjust width as necessary */
            min-height: 500px;
            height: 99%;
            padding: 20px;
            border: 0px solid #ddd;
            border-radius: 8px;
            background-color: #fff;
            box-shadow: 0 0 15px rgba(0,0,0,0.2);
            margin-left: 20px;
        }


        .payment-box {
            width: 20%; /* Adjust width as necessary */
            padding: 20px;
            border: 0px solid #ddd;
            border-radius: 8px;
            background-color: #fff;
            box-shadow: 0 0 15px rgba(0,0,0,0.2);
            height: 20%;
        }

        .payment-box input {
        /* Adjust the width of the input to ensure it doesn't exceed the container's width */
          width: 85%; /* Adjust as needed, make sure the sum of label width and input width is less than 100% */
          margin-right: 10px; /* Optional: Adds some space after the input */;
        }

        .input-symbol-dollar {
            position: relative;
        }
        .input-symbol-dollar input {
            padding-left:18px;
        }
        .input-symbol-dollar:before {
            position: absolute;
            top: 0;
            content:"$";
            left: 5px;
        }



        label {
            display: block;
            margin-top: 20px;
            font-weight: bold;
        }
        input {
            width: 40%;
            padding: 10px;
            margin-top: 5px;
            border: 2px solid #ddd;
            border-radius: 4px;
            transition: border-color 0.3s;
        }

        select {
          width: 100%; /* Adjusting based on the margin-right of the input fields */
          padding: 10px;
          margin-top: 5px;
          border: 2px solid #ddd;
          border-radius: 4px;
          transition: border-color 0.3s;
        }
        input:focus, select:focus {
            border-color: #ff8c00;
            outline: none;
        }
        button {
            width: 100%;
            padding: 10px;
            background-color: #ff8c00;
            color: white;
            border: none;
            cursor: pointer;
            font-size: 16px;
            margin-top: 20px;
            transition: background-color 0.3s;
            border-radius: 4px;
        }
        button:hover {
            background-color: #e07c00;
        }
        .fade-in {
            animation: fadeIn 0.5s;
        }
        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }
    </style>
</head>
<body>
    <div class="sidenav">
        <img src="brixel.png" style="width:128px;height:128px;" class="center">
        <div class="home">
            <img src="home.png" style="width:30px;height:30px;", align="left">
            <a href="#home", align="left">Home</a>
        </div>
                <div class="order">
            <img src="order.png" style="width:30px;height:30px;", align="left">
            <a href="#home", align="left">Order</a>
        </div>
                <div class="transactions">
            <img src="transactions.png" style="width:30px;height:30px;", align="left">
            <a href="#home", align="left">Transactions</a>
        </div>
                <div class="messages">
            <img src="messages.png" style="width:30px;height:30px;", align="left">
            <a href="#home", align="left">Messages</a>
        </div>
                <div class="home">
            <img src="orderhistory.png" style="width:30px;height:30px;", align="left">
            <a href="#home", align="left">Order History</a>
        </div>
                        <div class="settings">
            <img src="settings.png" style="width:30px;height:30px;", align="left">
            <a href="#home", align="left">Settings</a>
        </div>

    </div>


<div class="container fade-in">
    <div class="header">
        <h1>Order</h1>
    </div>
    <div class="form-container"> <!-- Add this container -->
        <form action="/submit-order" method="post">
                        <label for="supplier">Supplier:</label>
            <select id="supplier" name="supplier">
                <option value="" disabled selected>Select Supplier</option>
                <option value="East Bay Food Distributors">East Bay Food Distributors</option>
                <option value="Pleasents Valley Microgreens">Pleasents Valley Microgreens</option>
                <option value="Fish Ranch">Fish Ranch</option>
                <option value="Key Lime Distributors">Key Lime Distributors</option>
            </select>

            <label for="product">Select Product:</label>
            <select id="product" name="product">
                <option value="Cod Fillet (20 pc)">Cod Fillet (20 pc)</option>
                <option value="Broccoli Microgreens 1 lb.">Broccoli Microgreens 1 lb.</option>
                <option value="Its not butter? (10 lb)">Its not butter? (10 lb)</option>
            </select>

            
                <label for="quantity">Quantity:</label>
                <input type="number" id="quantity" name="quantity" min="1" max="1000">

                <label for="price">Price per Unit:</label>
                <span class="input-symbol-dollar">
                <input type="number" id="price" name="price" min="0.00" max="10000.00" step="0.01", value="Read-only value" readonly>
            </span>
           

                <label for="datef">Date:</label>
                <input type="date" id="date" name="date">


                <label for="frequency">Frequency</label>
                <select id="frequency" name="frequency">
                <option value="" disabled selected>Select Frequency</option>
                <option value="once">Once</option>
                <option value="weekly">Weekly</option>
                <option value="monthly">Monthly</option>
                </select>
                <label for="deliveries"># Deliveries</label>
                <input type="number" id="deliveries" name="deliveries">
           





        </form>

        <div class="payment-box">
            <h2>Payment Info</h2>
            <p>American Express Account Ending in 3492</p>
            <p>Billing: 1234 Fake Ave, Citytown, CA, 90210</p>
            <p>Shipping: 1234 Fake Ave, Citytown, CA, 90210</p>
            <!-- You can add more details here as needed -->
            <label for="total">Total:</label>


            <span class="input-symbol-dollar">
            <input type="number" id="total" name="total" min="0.00" max="100000.00" step="0.01", value="Read-only value" readonly>
            </span>
            <button type="button" id="place-order">Place Order</button>
            <div id="delivery-dates"></div>
        </div>
        <div class="invoice-box">

            <h2>Invoice</h2>
            <div id="invoice-contents">
            </div>

            <!-- You can add more details here as needed -->

        </div>
    </div>
</div>






<!-- ... javascript code ... -->


<!-- ... Updating the products available based on the suppliers  ... -->
<!-- ... Updating the price based on product  ... -->

<script>
    const today = new Date().toISOString().split('T')[0]; // Gets today's date and formats it as YYYY-MM-DD
    document.getElementById('date').setAttribute('min', today);

    const supplierInput = document.getElementById('supplier');
    const productInput = document.getElementById('product');
    const priceInput = document.getElementById('price');
    const quantityInput = document.getElementById('quantity');
    const deliveriesInput = document.getElementById('deliveries');
    const totalInput = document.getElementById('total');
    const invoiceContents = document.getElementById('invoice-contents');
    const placeOrderButton = document.getElementById('place-order');
    const dateInput = document.getElementById('date');
    const orderForm = document.querySelector('form'); // Assuming there's only one form on the page
    const frequencyInput = document.getElementById('frequency');
    const deliveryDatesDiv = document.getElementById('delivery-dates')

    const productsBySupplier = {
        "East Bay Food Distributors": ["Butter 10lb", "Milk 10 gal", "85% lean ground beef (10lb)"],
        "Pleasents Valley Microgreens": ["broccoli microgreens (10lb)", "sinatch microgreens (10lb)", "buckwheat microgreens (10lb)"],
        "Fish Ranch": ["Cod Fillet (6 lb)", "Talapia (5 ct.)", "Ahi Tuna (1 fish)"],
        "Key Lime Distributors": ["Crate of Limes", "Buttermilk (8 gallon)", "Honey Grahm Cracker (10 boxes)"],
    };

    function updateTotal() {
        const price = parseFloat(priceInput.value) || 0;
        const quantity = parseInt(quantityInput.value) || 0;
        const deliveries = parseInt(deliveriesInput.value) || 0;
        const total = price * quantity * deliveries;
        totalInput.value = total.toFixed(2); // Format to 2 decimal places
    }


    function calculateDeliveryDates() {
    if (!dateInput.value) {
        deliveryDatesDiv.innerHTML = "Please enter a valid start date.";
        return; // Exit the function if no date is provided
    }

    const startDate = new Date(dateInput.value);
    if (isNaN(startDate.getTime())) {
        deliveryDatesDiv.innerHTML = "Invalid date. Please enter a valid start date.";
        return; // Exit the function if date is invalid
    }

    const frequency = frequencyInput.value;
    const numDeliveries = parseInt(deliveriesInput.value);
    const dates = [];

    for (let i = 0; i < numDeliveries; i++) {
        let date = new Date(startDate);

        if (frequency === 'weekly') {
            date.setDate(date.getDate() + (i * 7));
        } else if (frequency === 'monthly') {
            date.setMonth(date.getMonth() + i);
        }  

        dates.push(`${date.getMonth() + 1}/${date.getDate()}/${date.getFullYear()}`);
    }

    deliveryDatesDiv.innerHTML = `Delivery Dates: ${dates.join(', ')}`;
}
    
    frequencyInput.addEventListener('change', calculateDeliveryDates);
    deliveriesInput.addEventListener('input', calculateDeliveryDates);
    dateInput.addEventListener('change', calculateDeliveryDates);



    supplierInput.addEventListener('change', function() {
        const selectedSupplier = supplierInput.options[supplierInput.selectedIndex].text;
        const products = productsBySupplier[selectedSupplier] || [];

        productInput.innerHTML = '';
        products.forEach(product => {
            const option = document.createElement('option');
            option.value = product;
            option.text = product;
            productInput.appendChild(option);
        });

        if (products.length) productInput.dispatchEvent(new Event('change'));
    });

    productInput.addEventListener('change', function() {
        const randomPrice = Math.random() * (100 - 50) + 50;
        priceInput.value = randomPrice.toFixed(2);
        updateTotal(); // Update total whenever product changes and price is updated
    });

    priceInput.addEventListener('input', updateTotal);
    quantityInput.addEventListener('input', updateTotal);
    deliveriesInput.addEventListener('input', updateTotal);

    placeOrderButton.addEventListener('click', function() {
        const total = totalInput.value;
        const supplier = supplierInput.options[supplierInput.selectedIndex].text;
        const product = productInput.options[productInput.selectedIndex].text;
        const date = deliveryDatesDiv.innerHTML
        const invoiceText = `Total: $${total} - ${supplier} - ${product} ${date}`;

        const newLineItem = document.createElement('p');
        newLineItem.textContent = invoiceText;
        invoiceContents.appendChild(newLineItem);

        orderForm.reset(); // Reset the form to clear all inputs
        updateTotal(); // Recalculate total after reset to ensure consistency
    });

    supplierInput.dispatchEvent(new Event('change'));
</script>




</body>
</html>
